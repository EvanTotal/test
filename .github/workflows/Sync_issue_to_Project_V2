name: Sync issue to Project V2

on:
  issues:
    types: [opened]

permissions:
  contents: read
  issues: write
  projects: write

jobs:
  add-to-project:
    runs-on: ubuntu-latest
    steps:
      - name: Add issue to Project V2
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const issueId = context.payload.issue.node_id;
            const projectId = "PVT_kwHODd007c4BEACq"; // <-- Replace with your personal Project V2 ID

            const mutation = `
              mutation($projectId:ID!, $contentId:ID!) {
                addProjectV2ItemById(input: {projectId: $projectId, contentId: $contentId}) {
                  item { id }
                }
              }
            `;

            const result = await github.graphql(mutation, {
              projectId: projectId,
              contentId: issueId,
            });

            console.log("Added to Project:", result);
